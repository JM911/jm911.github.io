---
layout: single
title:  "Drunken Passenger Problem"
categories: etc
tag: [math]
toc: true
published: true
---

최근 유튜브에서 우연히 Drunken Passenger 문제를 발견하고 풀어봤는데 영상과 조금 다른 흐름으로 풀어보아 기록으로 남겨본다.  
[임커밋님의 원본 영상 링크](https://youtu.be/zznpJFhuLTg?si=XTUIF1T9llsccsDB)

<!-- <iframe width="560" height="315" src="https://www.youtube.com/embed/zznpJFhuLTg?si=XTUIF1T9llsccsDB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe> -->

# 문제 설명
![image](https://jm911.github.io/assets/images/240901/1.webp)  
[그림 출처](https://medium.com/@rishidarkdevil/the-drunk-passenger-problem-554ebb7bd151)

비행기에 100명의 승객이 자신의 자리를 찾아 앉으려고 한다. 각 승객에는 1, 2, ..., 100 의 번호가 부여되어 있고 자신의 좌석에도 같은 번호가 붙어있다. 1번 승객부터 차례대로 자신의 좌석을 찾아 앉으려고 한다.  
그런데 이때 1번 승객이 술에 취해 1번 ~ 100번 좌석 중 랜덤으로 앉게 된다. 다른 사람들은 정상적으로 자신의 좌석을 찾아가서 앉으려고 하지만, 만약 자신의 좌석에 이미 다른 사람이 있으면 이 사람도 남은 좌석 중에 랜덤으로 골라 그 좌석에 앉는다.  
이 경우 마지막 100번 승객이 자신의 좌석인 100번 좌석에 제대로 앉을 확률을 구하시오. (어느 경우든 랜덤으로 좌석을 고를 때는 모든 좌석이 같은 확률을 가진다)

# 첫 풀이 시도

문제를 처음 본다면 대부분 1번이 1번에 앉을 경우에 100번이 제대로 앉을 확률, 2번에 앉을 경우 100번이 제대로 앉을 확률, ... 의 순서로 모든 경우를 계산하려고 시도할 것이다.  

그런데 조금 계산하다보면 깨닫게 되지만 계산이 꼬리에 꼬리를 물고 늘어져서 쉽지 않다.  
예를 들어 1번이 5번 좌석에 앉았다면, 2, 3, 4번 승객은 제대로 앉고 5번 승객이 또 랜덤으로 앉아야 한다. 여기서부터 다시 또 경우의 수 분할이 되어 100번까지 계산한다면 끝도 없이 늘어나는 것이다.  

결국 이런 형태의 풀이는 비현실적이라는 것을 깨닫고 더 이상 어떡해야 할지 깜깜해지는데, 이런 경우에 내가 수학적인 풀이를 시도하는 과정을 적어보겠다. (풀이만 간단하게 적는 것은 아니므로 다소 장황함)

# 일반화
일단 목표 번호를 100번이라는 큰 수로 정했다는 것은, 아마도 200, 300 에 대해서도 구하기 쉬울 가능성이 높다.  
물론 이건 어디까지나 추측이므로 함정에 빠지는 것일 수도 있지만, 여기선 그렇게 가정해서 풀이를 시도해 볼만 하다고 판단했다.  

즉, 이 가정을 토대로 100이 아니라 일반적인 n이라는 숫자에 대해 구하는 것으로 문제를 더 확장해본다.  
문제를 더 어렵게 만든다고 보여질 수도 있지만 어떨 때는 100이라는 명확한 목표 숫자가 풀이를 떠올리는 데 더 방해가 될 수도 있으므로 이런 시도를 해보는 것이다.

문제를 일반화하면 n번이 제대로 앉을 확률을 구하는 문제가 되고, 이 확률을 $P_n$이라고 하자. (n은 자연수)
이후 과정은 다음과 같다.

# 생각 과정

## (1) n이 작을 때 + 답 추측
가장 먼저 시도해야할 것은 n이 작을 때의 계산이다. 아래에서 확인하겠지만 n이 4를 넘어가면 많이 복잡하므로 4까지만 살펴볼 것이다.  
일반적인 풀이가 쉽게 떠오르지 않을 때 직관을 유도하기 가장 좋은 방법이라고 생각한다.

### i) $n=1$ 일 때
좌석이 1번 뿐이므로 무조건 제대로 앉을 수 밖에 없다.

$$P_1 = 1$$

### ii) $n=2$ 일 때
좌석이 2개이므로 두 가지 경우로 나뉜다.  
1. 1번이 1번 좌석에 앉을 경우 - 성공
2. 1번이 2번 좌석에 앉을 경우 - 실패

첫 번째 경우 2번은 2번 좌석에 앉아 성공, 두 번째 경우 2번은 1번 좌석에 앉아 실패가 된다.
두 경우 모두 확률은 같으므로 최종 확률은 다음과 같다.  

$$P_2 = \frac{1}{2} \times 1 = \frac{1}{2}$$

### iii) $n=3$ 일 때
좌석이 3개이므로 세 가지 경우로 나뉜다.
1. 1번이 1번 좌석에 앉을 경우 - 성공
2. 1번이 2번 좌석에 앉을 경우
   1. 2번이 1번 좌석에 앉을 경우 - 성공
   2. 2번이 3번 좌석에 앉을 경우 - 실패
3. 1번이 3번 좌석에 앉을 경우 - 실패

첫 번째 경우는 모두 제대로 앉으므로 성공이다.  
두 번째 경우는 다시 두 가지로 나뉘는데, 2번이 1번 좌석에 앉을 경우, 2번이 3번 좌석에 앉을 경우이다. 당연히 2번이 1번 좌석에 앉을 때만 성공이다.
세 번째 경우는 3번 좌석이 이미 차지되었으므로 실패다.

$$P_3 = \frac{1}{3} + \frac{1}{3} \times \frac{1}{2} = \frac{1}{2}$$

### iv) $n=4$ 일 때
여기서부터는 슬슬 복잡해진다.  
일단 경우가 네 가지로 나뉜다는 것은 명확하고, 이 중에 '1번이 2번 좌석에 앉을 경우'가 문제가 된다.  
왜냐하면 다시 또 2번 사람이 앉을 수 있는 좌석이 1번, 3번, 4번으로 세 가지나 되고 또 3번이 어디에 앉고... 이렇게 처음에 문제를 어렵다고 느낀 그 지점으로 돌아오는 것이다.  
하지만 여기가 핵심이므로 불편함을 무릅쓰고 경우를 다 따져보자.  

1. 1번이 1번 좌석에 앉을 경우 - 성공 ($\frac{1}{4}$)
2. 1번이 2번 좌석에 앉을 경우
   1. 2번이 1번 좌석에 앉을 경우 - 성공 ($\frac{1}{4} \times \frac{1}{3}$)
   2. 2번이 3번 좌석에 앉을 경우
      1. 3번이 1번 좌석에 앉을 경우 - 성공 ($\frac{1}{4} \times \frac{1}{3} \times \frac{1}{2}$)
      2. 3번이 4번 좌석에 앉을 경우 - 실패 
   3. 2번이 4번 좌석에 앉을 경우 - 실패
3. 1번이 3번 좌석에 앉을 경우
   1. 3번이 1번 좌석에 앉을 경우 - 성공 ($\frac{1}{4} \times \frac{1}{2}$)
   2. 3번이 4번 좌석에 앉을 경우 - 실패
4. 1번이 4번 좌석에 앉을 경우 - 실패

$$P_4 = \frac{1}{4} + (\frac{1}{4} \times \frac{1}{3}) + (\frac{1}{4} \times \frac{1}{3} \times \frac{1}{2}) + (\frac{1}{4} \times \frac{1}{2}) = \frac{1}{2}$$


### 추측 및 인사이트
우선 위 결과를 보면 모든 P 값이 $\frac{1}{2}$이므로 자연스럽게 $P_n = \frac{1}{2}$이 아닐지 추측해볼 수 있다.

그리고 확률을 구하는 과정을 살펴보면 더 확실한 인사이트를 하나 얻을 수 있다.  
![image](https://jm911.github.io/assets/images/240901/2.png)  
위 캡처는 n=4 일 때의 2번 경우를 n=3 일 때와 비교한 것인데, 보다시피 **경우의 수가 나뉘는 모양이 매우 유사함**을 확인할 수 있다.  

이것을 유념해서 더 살펴보면 또 아래의 상황도 확인할 수 있다.  
![image](https://jm911.github.io/assets/images/240901/3.png)  
사실 경우가 너무 단순하게 두 가지 뿐이라 눈치채기 힘들지만, 앞에서 이미 연관성을 확인한 후 생각해보면 이쪽도 유사함을 확인할 수 있다.

즉, 여기서 최종적으로 추측 가능한 점은 아래 두 가지다.
1. 답은 $\frac{1}{2}$
2. $P_n$과 $P_{n-1}$, $P_{n-2}$, ... 는 어떤 연관성이 있다. **즉, 점화식으로 표현이 가능하다.** (따라서 이것으로 1번 증명이 가능하다)


## (2) 1번이 k번에 앉았을 때?
위 추측을 좀 더 구체화하기 위해 1번 사람이 k번 좌석에 앉았을 경우에 어떤 특징이 있는지 살펴보자.  
이 경우 k번 사람에 도달하기 전까지, 즉, 2번 ~ k-1번 사람까지는 자기 자리에 제대로 앉을 수 있다.  
그리고 k번 사람이 어디에 앉을지에 따라 또 새로운 경우의 수가 나뉘는데, 여기서 경우의 수를 다시 나누지 않고 일단 상황 자체를 통째로 재구성해보는 것이다.  
(이런 시도를 떠올릴 수 있는 것은 앞에서 빨간 네모로 표시한 것처럼 한 가지 경우가 다른 경우와 통째로 연관이 있다는 것을 파악했기 때문)

이때 남은 사람은 k번, k+1번, ..., n번 으로, 총 n-k+1 명이고 k번 사람이 랜덤 착석한다.  
남은 좌석은 1번, k+1번, k+2번, ..., n번 으로, 마찬가지로 총 n-k+1 개이다.

다시 한 번 목표를 상기하자면, 우리는 위 상황을 $P_i$ (i는 n 미만의 자연수)와 연관시키려는 것이 목적이다.  
이를 위해 사람 수가 n-k+1 일 때의 P값, 즉, $P_{n-k+1}$을 구하는 경우에 대해 묘사하면 다음과 같다.  
남은 사람은 1번, 2번, ..., n-k+1번이고 1번 사람이 랜덤 착석한다.  
남은 좌석은 1번, 2번, ..., n-k+1번이다.

**위 두 상황을 비교하면 각 번호의 사람과 각 번호의 좌석이 일대일로 매칭된다는 것을 확인할 수 있다.**  
사람은 k번이 1번으로, k+1번이 2번으로, ..., n번이 n-k+1번으로 대응된다.  
좌석은 1번은 1번으로, k+1번이 2번으로, ..., n번이 n-k+1번으로 대응된다.

**즉, 최종적으로 1번이 k번 좌석에 앉은 상황에서의 확률이 $P_{n-k+1}$과 같다는 것을 확인한 것이다.**


## (3) 점화식
앞에서 모든 핵심 아이디어 구상은 끝났고, 이제 식으로 정리만 하면 된다.  
편의를 위해 1번이 k번째 앉았을 때의 확률을 $Q_k$라고 부르자.  
각 경우가 일어날 확률은 $\frac{1}{n}$이므로 최종 확률은 다음 식으로 계산될 것이다.

$$P_n = \frac{1}{n}(Q_1 + Q_2 + ... + Q_n)$$

참고로 k가 1 또는 n일 때는 특수한 경우이므로 따로 구하고, 나머지를 핵심 점화식으로 표현할 것이다.  
(앞에서 편의상 설명은 생략했지만, 이때가 특수하다는 것은 k번에 앉았다는 것을 가정하는 경우를 잘 살펴보면 k가 2이상 n-1이하일 때만 논리 전개가 자연스럽다는 것을 알 수 있다)

### i) $k = 1$
이때는 1번이 1번 좌석에 앉은 경우이므로 나머지 사람들이 모두 제대로 앉을 수 있어서 그냥 1이다.

$$Q_1 = 1$$

### ii) $k = n$
이때는 n번 좌석이 바로 차지되었으므로 n번 사람은 제대로 앉을 수 없어서 그냥 0이다.

$$Q_n = 0$$

### iii) $1 < k < n$
앞에서 살펴본 것처럼 다음 식으로 표현 가능하다.

$$Q_k = P_{n-k+1}$$

### 최종
최종 점화식은 아래처럼 정리할 수 있다. $(n \geq 3)$

$$P_n = \frac{1}{n}(Q_1 + Q_2 + ... + Q_{n-1} + Q_n)\\
= \frac{1}{n}(1 + P_{n-1} + P_{n-2} + ... + P_2 + 0)\\
= \frac{1}{n}(1 + P_2 + ... + P_{n-1})$$


## (4) 정답 및 증명 (수학적 귀납법)
이제 우리는 $(n \geq 3)$일 경우의 점화식을 알고, $P_1$, $P_2$, $P_3$ 값을 알고 있으므로 모든 $P_n$을 직접 계산할 수 있다.  
최종 목표는 $n=100$인 경우의 값을 계산하는 것이므로 모두 계산하기는 힘들고, 앞에서 추측했던 첫 번째 사항, 답이 $\frac{1}{2}$이라는 것을 사용할 것이다.  

즉, 위 점화식에 대해 증명할 최종 명제는 다음과 같다.

$$P_n = \frac{1}{2} \space(n \geq 3)$$

수학적 귀납법을 사용하기 위해 $n = 3, ..., m \space (m \geq 3)$일 때 위 명제가 참이라고 가정하고 $n=m+1$ 일 때도 참임을 증명할 것이다.

$$P_{m+1} = \frac{1}{m+1}(1 + P_2 + P_3 + ... + P_m)\\
= \frac{1}{m+1}(1 + \frac{1}{2} + \sum_3^m{P_k})\\
= \frac{1}{m+1}(\frac{3}{2} + (m-3+1) * \frac{1}{2})\\
= \frac{1}{m+1}(\frac{3 + m - 2}{2})\\
= \frac{1}{m+1} \times \frac{m+1}{2} = \frac{1}{2}$$

위 과정으로 모든 증명이 완료되며, **답은 $\frac{1}{2}$이다.**

# 추가 코멘트  
개인적으로는 이런 식의 차근차근 쌓아나가는 풀이보다는 원본 영상처럼 (수학적인 언어로 풀어 쓰기에는 조금 힘들어도) 직관적인 형태를 이해하는 것이 더 중요하다고 생각한다.  
(중요하다는 것의 의미는 근본적으로 다른 문제들을 풀기 위한 사고력을 키우려면 어떤 형태의 공부를 추구해야 하냐는 기준)  
하지만 면접처럼 중요한 순간을 위해 이런 식으로 논리의 흐름을 따라 풀어보는 방식도 익혀놓는 것이 좋은 것 같다.

